<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="card">
        <div class="card-header bg-primary text-white">
          <h3 class="card-title mb-0">
            <i class="bi bi-plus-circle me-2"></i>Add New Product
          </h3>
        </div>
        <div class="card-body">
          <!-- Success Message -->
          <div *ngIf="successMessage" class="alert alert-success alert-dismissible fade show" role="alert">
            <i class="bi bi-check-circle-fill me-2"></i>
            {{ successMessage }}
            <button type="button" class="btn-close" (click)="successMessage = null"></button>
          </div>

          <!-- Error Message -->
          <div *ngIf="error" class="alert alert-danger alert-dismissible fade show" role="alert">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>
            {{ error }}
            <button type="button" class="btn-close" (click)="error = null"></button>
          </div>

          <form [formGroup]="productForm" (ngSubmit)="onSubmit()" novalidate>
            <!-- Product ID -->
            <div class="mb-3">
              <label for="productId" class="form-label">Product ID *</label>
              <input 
                type="number" 
                class="form-control" 
                id="productId" 
                formControlName="id"
                [class.is-invalid]="shouldShowError(id)"
                [class.is-valid]="id?.valid && (id?.dirty || id?.touched)"
                placeholder="Enter unique product ID">
              <div *ngIf="shouldShowError(id)" class="invalid-feedback">
                {{ getErrorMessage(id) }}
              </div>
              <div *ngIf="id?.valid && (id?.dirty || id?.touched)" class="valid-feedback">
                Looks good!
              </div>
            </div>

            <!-- Product Name -->
            <div class="mb-3">
              <label for="productName" class="form-label">Product Name *</label>
              <input 
                type="text" 
                class="form-control" 
                id="productName" 
                formControlName="name"
                [class.is-invalid]="shouldShowError(name)"
                [class.is-valid]="name?.valid && (name?.dirty || name?.touched)"
                placeholder="Enter product name (max 50 characters)">
              <div *ngIf="shouldShowError(name)" class="invalid-feedback">
                {{ getErrorMessage(name) }}
              </div>
              <div *ngIf="name?.valid && (name?.dirty || name?.touched)" class="valid-feedback">
                Looks good!
              </div>
              <div class="form-text text-muted">
                {{ name?.value?.length || 0 }}/50 characters
              </div>
            </div>

            <!-- Description -->
            <div class="mb-3">
              <label for="productDescription" class="form-label">Description *</label>
              <textarea 
                class="form-control" 
                id="productDescription" 
                formControlName="description"
                rows="4"
                [class.is-invalid]="shouldShowError(description)"
                [class.is-valid]="description?.valid && (description?.dirty || description?.touched)"
                placeholder="Enter product description (max 255 characters)"></textarea>
              <div *ngIf="shouldShowError(description)" class="invalid-feedback">
                {{ getErrorMessage(description) }}
              </div>
              <div *ngIf="description?.valid && (description?.dirty || description?.touched)" class="valid-feedback">
                Looks good!
              </div>
              <div class="form-text text-muted">
                {{ description?.value?.length || 0 }}/255 characters
              </div>
            </div>

            <!-- Price and Units -->
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="productPrice" class="form-label">Price ($) *</label>
                <div class="input-group">
                  <span class="input-group-text">$</span>
                  <input 
                    type="number" 
                    class="form-control" 
                    id="productPrice" 
                    formControlName="price"
                    min="0"
                    step="0.01"
                    [class.is-invalid]="shouldShowError(price)"
                    [class.is-valid]="price?.valid && (price?.dirty || price?.touched)"
                    placeholder="0.00">
                </div>
                <div *ngIf="shouldShowError(price)" class="invalid-feedback d-block">
                  {{ getErrorMessage(price) }}
                </div>
                <div *ngIf="price?.valid && (price?.dirty || price?.touched)" class="valid-feedback d-block">
                  Looks good!
                </div>
              </div>

              <div class="col-md-6 mb-3">
                <label for="productUnits" class="form-label">Units in Stock *</label>
                <input 
                  type="number" 
                  class="form-control" 
                  id="productUnits" 
                  formControlName="units"
                  min="0"
                  [class.is-invalid]="shouldShowError(units)"
                  [class.is-valid]="units?.valid && (units?.dirty || units?.touched)"
                  placeholder="0">
                <div *ngIf="shouldShowError(units)" class="invalid-feedback">
                  {{ getErrorMessage(units) }}
                </div>
                <div *ngIf="units?.valid && (units?.dirty || units?.touched)" class="valid-feedback">
                  Looks good!
                </div>
              </div>
            </div>

            <!-- Form Actions -->
            <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-4">
              <button 
                type="button" 
                class="btn btn-outline-secondary me-md-2" 
                (click)="onCancel()"
                [disabled]="loading">
                <i class="bi bi-x-circle me-1"></i>Cancel
              </button>
              <button 
                type="submit" 
                class="btn btn-primary" 
                [disabled]="loading || productForm.invalid">
                <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>
                <i class="bi bi-plus-circle me-1" *ngIf="!loading"></i>
                {{ loading ? 'Adding Product...' : 'Add Product' }}
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>